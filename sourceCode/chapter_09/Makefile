# ===================================================
# Makefile for C++ practice project
# ===================================================

# 编译器
CXX := clang++

# 编译选项
# -MMD 自动生成 .d 依赖文件，追踪头文件变化
CXXFLAGS := -std=c++17 -Wall -Wextra -O2 -g -MMD

# 源文件列表（只列出需要编译的 .cpp）
SRCS := 9.12_namesp.cpp 9.13_usenmsp.cpp

# 根据 .cpp 自动推导出 .o 和 .d 文件名
OBJS := $(SRCS:.cpp=.o)
DEPS := $(OBJS:.o=.d)

# 最终生成的可执行文件名
TARGET := a.out

# ===================================================
# 默认目标：生成可执行文件
# ===================================================
all: $(TARGET)

# 链接阶段
$(TARGET): $(OBJS)
	$(CXX) $(CXXFLAGS) $(OBJS) -o $(TARGET)

# 编译阶段（自动规则：.cpp -> .o）
%.o: %.cpp
	$(CXX) $(CXXFLAGS) -c $< -o $@

# ===================================================
# 清理目标文件和依赖文件
# ===================================================
clean:
	rm -f $(OBJS) $(DEPS) $(TARGET)

# ===================================================
# 自动包含依赖文件（由 -MMD 自动生成）
# ===================================================
-include $(DEPS)

# 防止与文件名冲突
.PHONY: all clean
